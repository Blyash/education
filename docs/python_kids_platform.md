# "Python Galaxy" — образовательная платформа по Python для детей 12+

## 1. Видение продукта
"Python Galaxy" — это веб-платформа для изучения языка Python, ориентированная на детей 12–15 лет. Сервис объединяет интерактивные уроки, встроенную среду программирования, мгновенную проверку решений и систему прогресса, похожую на игровую. Цели продукта:

* сделать обучение Python доступным и увлекательным с планшета или ноутбука;
* дать учащимся возможность сразу применять знания в встроенном редакторе кода с компилятором и автопроверкой;
* обеспечить педагогов инструментами для отслеживания прогресса и выдачи заданий.

## 2. Ключевые особенности
* **Интерактивные блоки уроков.** Материал разбит на короткие карточки с пояснениями, примерами и мини-викторинами.
* **Встроенный Python-компилятор.** Выполнение кода осуществляется в браузере через Pyodide/WebAssembly, дополнительно предусмотрен серверный режим (Docker + ограниченный CPython) для задач, требующих файлового ввода/вывода.
* **Интерактивная IDE.** Подсветка синтаксиса, автодополнение, подсказки, сохранение черновиков, тёмная/светлая тема.
* **Система уровней.** Курсы поделены на миры и уровни. Пройденные уроки, решённые задачи и набранные очки открывают новые миры.
* **Мгновенная проверка задач.** Юнит-тесты, проверка стиля (pylint с упрощённым профилем), персональные подсказки.
* **Аккаунты и прогресс.** Регистрация с подтверждением почты или через родительский аккаунт. Сохранение прогресса, достижений, истории решений.
* **Учительский кабинет.** Создание классов, назначение заданий, мониторинг результатов, экспорт отчётов.
* **Адаптивный дизайн для планшетов.** Лэйауты под 1024×768 и 1366×768, поддержка жестов, крупные элементы управления.

## 3. Педагогическая модель
* Спиральное обучение: темы возвращаются на новом уровне сложности.
* Каждая тема содержит: введение, пример, интерактивную анимацию, практику и тест.
* Блоки не длиннее 10 минут. После каждого блока — короткая мини-игра/челлендж.
* Использование сюжетной линии (путешествие по планетам Python Galaxy).

## 4. Архитектура решения
### 4.1 Общая схема
* **Frontend:** React + TypeScript, Next.js для SSR и SEO, UI-библиотека — Chakra UI или Tailwind + Headless UI. Поддержка PWA для офлайн-доступа к теории.
* **Backend:** FastAPI (Python) + PostgreSQL. Redis для кэширования и очередей. Celery для фоновых задач проверки решений и рассылок.
* **Code Runner:**
  * Клиентский режим: Pyodide + Monaco Editor, ограниченные ресурсы.
  * Серверный режим: Docker-контейнеры с CPython 3.11, ограничение по CPU/RAM, файловая песочница. Работа через очередь Celery.
* **Аутентификация:** JSON Web Tokens (доступ) + refresh-токены, поддержка OAuth (Google, Microsoft для школ).
* **Хранение файлов:** S3-совместимое облако (например, MinIO) для загрузки проектов и медиа.
* **Аналитика:** Snowplow/Segment для пользовательских событий, Prometheus + Grafana для мониторинга.

### 4.2 Микросервисы
1. **auth-service** — регистрации, вход, управление ролями.
2. **learning-service** — курсы, уроки, задания, прогресс.
3. **runner-service** — запуск кода, хранение очередей, получение результатов тестов.
4. **notification-service** — email, пуш-уведомления, напоминания родителям.
5. **teacher-service** — управление классами и отчётность.

### 4.3 Диаграмма потоков
1. Пользователь открывает урок → frontend запрашивает lesson API → отображает блоки.
2. При запуске кода запрос уходит в runner-service (клиентский или серверный режим).
3. Результат выполнения возвращается в UI и сохраняется в learning-service как попытка.
4. При успешном прохождении урока обновляется прогресс, начисляются очки и выдаются бейджи.

## 5. Структура курсов
### 5.1 Миры и уровни
| Мир | Уровень | Темы | Практика |
| --- | --- | --- | --- |
| **"Космопорт" (Базовый)** | 1 | Знакомство с Python, ввод-вывод | 5 задач + 3 мини-теста |
|  | 2 | Переменные, типы данных | 6 задач |
|  | 3 | Условные конструкции | 8 задач |
|  | 4 | Циклы | 10 задач + мини-игра по отладке |
| **"Орбита" (Продвинутый базовый)** | 5 | Функции, области видимости | 8 задач |
|  | 6 | Строки и списки | 10 задач |
|  | 7 | Словари, множества | 10 задач |
| **"Комета" (Средний уровень)** | 8 | Работа с файлами | 8 задач |
|  | 9 | Модули и пакеты | 6 задач + проект |
|  | 10 | Тестирование, отладка | 6 задач |
| **"Галактическая лаборатория" (Продвинутый)** | 11 | ООП основы | 10 задач |
|  | 12 | Исключения, управление ошибками | 8 задач |
|  | 13 | Алгоритмы: сортировка, поиск | 12 задач |
|  | 14 | Мини-проект "Анализ данных" | Итоговый проект |

### 5.2 Пример урока
* **Тема:** "Переменные и типы данных".
* **Блоки:**
  1. Анимация с роботом, объясняющим переменные.
  2. Интерактивная карточка "Перетащи название типа к примеру".
  3. Практика: написать программу, которая запрашивает имя и возраст и выводит приветствие.
  4. Тест из 5 вопросов (множественный выбор, drag & drop, ввод ответа).
* **Задачи:** 6 задач разной сложности с мгновенной проверкой и подсказками.

### 5.3 Примеры задач по уровням
* **Уровень 1:** "Напиши программу, которая выводит приветствие пользователю"; "Составь историю, используя ввод двух слов".
* **Уровень 4:** "Нарисуй шахматную доску 8×8 символами"; "Посчитай количество чётных чисел в диапазоне".
* **Уровень 7:** "Сформируй словарь покупок и посчитай итоговую стоимость".
* **Уровень 10:** "Напиши функцию, которая проверяет корректность паролей по заданным правилам".
* **Уровень 14:** Проект "Галактический каталог животных": загрузить CSV, обработать данные, визуализировать результаты.

## 6. Геймификация
* **Очки опыта (XP)** за уроки, задачи, streak за ежедневные входы.
* **Бейджи:** «Первый запуск», «Звёздный отладчик», «Мастер функций» и др.
* **Лига друзей:** возможность соревноваться с одноклассниками.
* **Персональные аватары и космические питомцы**, прокачиваемые за очки.

## 7. UI/UX
* **Главная страница:** герой с иллюстрацией галактики, CTA «Начать обучение», блоки с преимуществами и отзывами.
* **Дашборд ученика:**
  * прогресс по мирам;
  * текущая миссия;
  * календарь streak;
  * рекомендации по повторению.
* **Экран урока:** 2-колоночный layout (теория/практика) на планшете переворачивается в вертикальный с вкладками.
* **IDE:** Monaco Editor, кнопки «Запустить», «Сбросить», «Подсказка». Режим полноэкранного просмотра.
* **Цветовая палитра:** темно-синий фон, неоново-фиолетовые акценты, пастельные иконки.
* **Иллюстрации:** игровые персонажи — роботы и инопланетяне.

## 8. Контент и методика
* Все объяснения написаны простым языком, с примерами из жизни подростков.
* При каждом новом термине — всплывающий словарик.
* Видеовставки с разбором задач 2–3 минуты.
* Раздел «Справочник» с поиском по терминам.
* Поддержка русской и английской локализации.

## 9. Система задач и автопроверка
* **Форматы задач:** ввод-вывод, выбор ответа, drag-and-drop, заполнение пропусков, рисование блок-схем.
* **Подсказки:** уровни подсказок, которые снижают XP, но помогают решать задачи.
* **Тесты:** автоматическая генерация нескольких наборов тестов, скрытые тесты.
* **Критерии оценивания проектов:** чек-лист для наставника + автоматическая проверка ключевых условий.

## 10. Сохранение прогресса
* Таблицы `users`, `profiles`, `lessons`, `lesson_attempts`, `tasks`, `submissions`, `achievements`, `streaks`.
* Прогресс сохраняется после каждого блока (autosave).
* Возможность синхронизации между устройствами. Работа офлайн (PWA) для теории с последующей синхронизацией.

## 11. Учительский и родительский кабинеты
* **Учитель:** создавать группы, назначать задания, отслеживать статистику, скачивать отчёты в CSV.
* **Родитель:** видеть прогресс ребёнка, устанавливать лимиты времени, получать уведомления об успехах.

## 12. Безопасность и приватность
* Хранение паролей через Argon2.
* Контроль родительского согласия (COPPA/GDPR-K).
* Логи действий пользователей для аудита.
* Регулярные бэкапы БД, шифрование на уровне диска.

## 13. План разработки
1. **Discovery (2 недели):** пользовательские интервью, прототипирование UI.
2. **MVP (3 месяца):**
   * регистрация, дашборд, 3 мира (уровни 1–9);
   * встроенный Pyodide-редактор;
   * автопроверка базовых задач;
   * базовый учительский кабинет.
3. **Бета (2 месяца):** геймификация, проекты, родительский кабинет.
4. **Release (1 месяц):** оптимизации, контент уровней 10–14, локализация.
5. **Поддержка:** ежемесячное добавление новых миссий и задач.

## 14. Технологический стек
* **Frontend:** Next.js, TypeScript, Chakra UI/Tailwind, Zustand для стейта, i18next.
* **Backend:** FastAPI, SQLAlchemy, Alembic, PostgreSQL, Redis, Celery.
* **DevOps:** Docker, Kubernetes (k3s для школ), GitHub Actions CI/CD, Sentry для ошибок.
* **Интеграции:** SendGrid (email), Firebase Cloud Messaging (пуши).

## 15. Дополнительные идеи
* Авторы курсов могут создавать собственные миссии через визуальный редактор.
* Интеграция с LMS (Moodle, Google Classroom) через LTI.
* AR-режим для визуализации алгоритмов (в перспективе).
* Мобильное приложение (React Native) на основе веб-кода.

## 16. Реализация прототипа

В каталоге `backend/` добавлен первый рабочий прототип API на FastAPI. Он реализует базовый пользовательский поток:

1. Регистрация и авторизация пользователей (in-memory, без постоянной БД).
2. Получение уроков, описанных в разделах «Космопорт» уровни 1–4, с блоками теории и практики.
3. Просмотр практических заданий с тестами и стартовым кодом.
4. Отправка решений и автоматическая проверка через запуск CPython в временной директории.
5. Сохранение прогресса и начисление XP при успешной проверке.

Это MVP-сервис, который станет основой для последующего наращивания функциональности (реальная БД, очереди на проверку, кабинеты учителя и родителя, аналитика).

